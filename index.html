<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://hv-camera-web-sg.s3-ap-southeast-1.amazonaws.com/hyperverge-web-sdk@3.3.5/src/sdk.min.js"></script>
  </head>
  <body>
    <center><h2>Hyperverge WebSDK Demo</h2></center>
    <div class="container">
      <div class="form-group">
        <center><button type="button" onclick="runLiveness();" class="btn btn-primary">Start Process</button></center>
      </div>
      <div id="div1"></div>
    </div>
    <script>
      // client calls the auth api to get the token from their backend server
		var jwtToken = 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6ImE0NmIxMCIsImhhc2giOiI1MGY4ZjAzNTZiNWI1YzE2ODM2OTE5NzBkYTc0OTIwYzQwYjNiN2I1MjlmN2Q3MWY3MTkzZDdmNzhiMjUxNGMwIiwiaWF0IjoxNjU1OTgyMDQ1LCJleHAiOjE2NTU5ODgwNDUsImp0aSI6IjE0NDRmMTU5LWM3MTAtNDk1OC04ZGQyLWJkYzUwNTA3MTQ1NCJ9.VS4_xUCTclxoAQs8yx15vcZ5Rvw5eNlhEC25t95hzkCJuLWkerTIHnc46WCG2FLuXHcAn1BcJpFk9v6oxtyckKPVaN7R6l_L6aT9vclb_LQKXKzNtMw5ceqqhEaS1c4GOpjW5Dot4ZJZAeSjO90V9hKdrtv4nUsy3Z82dcL_ewQ'
		HyperSnapSDK.init(jwtToken, HyperSnapParams.Region.India);
		HyperSnapSDK.startUserSession();
	  
	 var faceImageBase64 = '';
	 var docImageBase64 = '';
	 // var imageBase64 = '';
	  
	 // Function wrapper for liveness button
	  function runLiveness(){
	  //For Face Capture Screen
		var hvFaceConfig = new HVFaceConfig(); // First create a hvFace config object
		hvFaceConfig.setShouldShowInstructionPage(true);
		hvFaceConfig.setLivenessAPIParameters({
		  rejectFaceMask: 'yes',
		  allowEyesClosed: 'no',
		  allowMultipleFaces: 'no',
		  rejectBlur: 'yes',
		});
		
		  //callback for Selfie	
		callback = (HVError, HVResponse) => {
			 if (HVError) {
			  var para = document.createElement('p');
			  var node = document.createTextNode(JSON.stringify(HVError));
			  para.appendChild(node);
			  var element = document.getElementById('div1');
			  element.appendChild(para);
			} 
			else {
				  var para = document.createElement('p');
				  var node = document.createTextNode(JSON.stringify(HVResponse));
				  para.appendChild(node);
				  var element = document.getElementById('div1');
				  element.appendChild(para);
				var apiResults = HVResponse.getApiResult();
				var apiHeaders = HVResponse.getApiHeaders();
				faceImageBase64 = HVResponse.getImageBase64();
				var attempts = HVResponse.getAttemptsCount();
				
				runOCRFront();
			}
		};

		HVFaceModule.start(hvFaceConfig, callback);// Start the HVFaceModule. Callback is the function that receives the data once the api call finishes.It gets two objects HVError and HVResponse.
		//faceImageBase64String = imageBase64;
	  }
	  
	 // Function wrapper for documents button
	 function runOCRFront(){ // Hopefully this 1 function should do both front and back for documents
	 
	hvDocConfig = new HVDocConfig();
        hvDocConfig.setOCRDetails(
          'https://ind-docs.hyperverge.co/v2.0/readKYC',
          hvDocConfig.DocumentSide.FRONT,
          { },
          { },
        );
        hvDocConfig.setShouldShowInstructionPage(true);
        hvDocConfig.setShouldShowDocReviewScreen(true);
	hvDocConfig.setChooseDocumentCaptureOption(true);
	hvDocConfig.docTextConfig.setDocCaptureTitle('Capture Front of ID Card');
	
	//docImageBase64String = imageBase64;
		 
	//Define Callback function for Document OCR
		 
	callback1 = (HVError, HVResponse) => {
		   if (HVError) {
				  var para = document.createElement('p');
				  var node = document.createTextNode(JSON.stringify(HVError));
				  para.appendChild(node);
				  var element = document.getElementById('div1');
				  element.appendChild(para);
      		  }
		else {
			  var para = document.createElement('p');
			  var node = document.createTextNode(JSON.stringify(HVResponse));
			  para.appendChild(node);
			  var element = document.getElementById('div1');
			  element.appendChild(para);
			var apiResults = HVResponse.getApiResult();
			var apiHeaders = HVResponse.getApiHeaders();
			docImageBase64 = HVResponse.getImageBase64();
			var attempts = HVResponse.getAttemptsCount();
			
			runFaceMatch();
		}
	};
	HVDocsModule.start(hvDocConfig, callback1); // Start the HVDocsModule. Callback is the function that receives the data once the api call finishes.It gets two objects HVError and HVResponse.
	
	}
	//function wrapper for OCR Back
	
	function runOCRBack(){
	
	 //For Document Back Capture Screen
		hvDocConfig = new HVDocConfig(); // First create a hvdoc config object
		hvDocConfig.setOCRDetails(
		'https://ind-docs.hyperverge.co/v2.0/readKYC',
		 hvDocConfig.DocumentSide.BACK,
		  {},
		  {},
		);
		hvDocConfig.setShouldShowDocReviewScreen(true);
		 hvDocConfig.setChooseDocumentCaptureOption(true);
		hvDocConfig.docTextConfig.setDocCaptureTitle('Capture Back of ID Card');

		 callback2 = (HVError, HVResponse) => {
			  if (HVError) {
				  var para = document.createElement('p');
				  var node = document.createTextNode(JSON.stringify(HVError));
				  para.appendChild(node);
				  var element = document.getElementById('div1');
				  element.appendChild(para);
       			 } 
			 else {
				  var para = document.createElement('p');
				  var node = document.createTextNode(JSON.stringify(HVResponse));
				  para.appendChild(node);
				  var element = document.getElementById('div1');
				  element.appendChild(para);
			var apiResults = HVResponse.getApiResult();
			var apiHeaders = HVResponse.getApiHeaders();
			var attempts = HVResponse.getAttemptsCount();
			
			runFaceMatch();
			}
		};
		HVDocsModule.start(hvDocConfig, callback2); // Start the HVDocsModule. Callback is the function that receives the data once the api call finishes.It gets two objects HVError and HVResponse.
	}
	//function wrapper for face match
	  function runFaceMatch(){
	 // callback for faceMatch
	callback = (HVError, HVResponse) => {
		 if (HVError) {
				  var para = document.createElement('p');
				  var node = document.createTextNode(JSON.stringify(HVError));
				  para.appendChild(node);
				  var element = document.getElementById('div1');
				  element.appendChild(para);
       			 } 
			 else {
				  var para = document.createElement('p');
				  var node = document.createTextNode(JSON.stringify(HVResponse));
				  para.appendChild(node);
				  var element = document.getElementById('div1');
				  element.appendChild(para);  
			var apiResults = HVResponse.getApiResult();
			var apiHeaders = HVResponse.getApiHeaders();
		  }
		};
	    
	HVNetworkHelper.makeFaceMatchCall(faceImageBase64, docImageBase64, {}, {}, callback); // Make Face Match call for a comparison between selfie and doc image   
	  } 
	  
	</script>
  </body>
</html>	
